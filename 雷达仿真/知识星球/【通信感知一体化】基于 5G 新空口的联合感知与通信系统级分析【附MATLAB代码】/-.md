# 基于 5G 新空口的联合感知与通信系统级分析

## 摘要

本研究针对基于多输入多输出（MIMO）5G 新空口（NR）波形的联合感知与通信（JSC）多波束系统展开探究。具体而言，研究考虑基站（BS）作为单基地传感器，通过利用部分发射功率进行波束扫描，对多个目标的距离、速度和到达角（DoA）进行估计，进而结合距离和到达角估计结果确定目标位置。在视距（LOS）条件下，研究从目标检测概率以及位置和速度估计的均方根误差（RMSE）角度，推导了该系统的感知性能。此外，研究还采用最优子模式分配（OSPA）度量，对存在多个目标时的系统性能进行了评估。最后，深入分析了影响系统性能的主要因素，其中包括为感知预留的功率占比。

## 引言

随着宽带移动无线电网络的广泛普及以及 5G 通信系统对毫米波频段的应用，频谱拥堵问题日益加剧。另一方面，借助射频（RF）信号实现的感知功能在自动驾驶、辅助生活、安全防护以及人机交互等众多应用领域受到了越来越多的关注 \[2]。在这一趋势下，兼具感知与通信功能的系统需求不断增长，这类系统中雷达与通信功能共享硬件平台和频段 \[3,4]，这种技术方式被称为联合感知与通信（JSC），其核心是利用通信网络发射的波形来实现感知功能。在该场景下，基于正交频分复用（OFDM）的信号被认为是适用于有源和无源雷达的理想选择。例如，在文献 \[5,6] 中，长期演进（LTE）和 5G 新空口（NR）等基于 OFDM 的通信系统被提及可用于此目的；文献 \[7] 则对频分双工（FDD）LTE 下行链路波形的自模糊函数（SAF）和互模糊函数（CAF）进行了评估。

文献中广泛探讨的另一种解决方案是基于机会信号的无源雷达。在这种方案中，通过去除雷达信号源来解决频谱共享问题，即无需发射雷达信号，仅利用环境中已存在的机会辐射源就能实现目标的定位与跟踪 \[8,9]。然而，这种雷达系统无法完全知晓发射信号的信息，只能依据从接收回波中提取的功率、角度和多普勒信息来进行检测与估计 \[10]。

文献 \[4] 探讨了 JSC 系统的应用场景。根据文献 \[11]，研究 JSC 可聚焦于简单的点对点通信（如车联网 \[12-17]，在自动驾驶领域有广泛应用）和复杂的移动 / 蜂窝网络 \[10,18-20]，后者有望彻底改变当前仅具备通信功能的移动网络。JSC 还有可能将无线电感知融入大规模移动网络，形成所谓的感知移动网络 \[10,21-24]。此外，有关毫米波 JSC 的研究文献证实了其在室内和车辆网络中的可行性与潜力 \[12,15,25-30]。特别是文献 \[25] 深入探讨了基于毫米波的 JSC 信号处理方面的内容，并重点关注波形设计。在毫米波频段，多输入多输出（MIMO）系统通过空间复用技术，能够为通信用户提供极高容量的链路并降低时延，同时凭借精确的到达角（DoA）估计能力，还能增强感知性能 \[31,32]。

部分关于 JSC 的研究主要聚焦于相控阵的单波束方法，即感知波束与通信波束方向一致 \[33]。由于这两种功能的需求差异极大，为解决这一问题，近期研究开始关注采用分离且共存的波束分别用于通信和感知。例如，文献 \[12,34] 提出了一种包含波束成形设计与优化的多波束框架，能够同时实现朝向用户设备（UE）的稳定通信波束和对环境进行扫描的感知波束。

目前，大多数关于 JSC 的研究精力都集中在设计信号处理技术上，旨在从环境中提取特征信息，如目标（例如汽车或人）的位置和速度，或者推断环境本身的信息，如房间的测绘或成像。然而，据作者所知，极少有研究从感知角度对 JSC 系统的性能进行探究，并结合现有技术给出目标参数估计精度相关的结果。鉴于此，本研究致力于对基于 5G NR 的 JSC 多波束系统进行分析，以明确关键方面及其在性能调控中的作用。具体而言，主要贡献如下：



1.  通过数值仿真，对作为单基地配置传感器的基站（BS）性能进行分析，该基站能够估计多个目标的距离、速度和到达角（DoA）。重点分析了用于感知的总辐射功率占比对系统性能的影响，并提出了一种算法来去除因波束扫描（受波束旁瓣影响）这一感知方法而产生的虚假目标。

2.  在单目标场景下，分析了通过距离和到达角估计实现目标定位所得到的位置估计均方根误差（RMSE），以及径向速度估计的精度。

3.  确定了影响性能的主要因素，并对工作在 Sub-6 GHz 和毫米波频段的两种系统配置进行了比较。

4.  在毫米波频段的多目标场景下，采用最优子模式分配（OSPA）度量，从定位和检测能力方面研究了所考虑系统的性能。

本文中，粗体大写字母表示矩阵，粗体小写字母表示向量，$(\cdot)^T$、$(\cdot)^\dagger$和$(\cdot)^c$分别表示向量 / 矩阵的转置、共轭转置和共轭，$\|\cdot\|_p$表示 p 范数算子，$\lceil\cdot\rceil$表示上取整函数。

全文结构安排如下：第二节描述系统模型和所提出的 JSC 方案；第三节介绍所采用的估计技术和重复目标修剪流程；第四节讨论如何使用 OSPA 度量来评估多目标系统的性能；第五节进行全面的性能分析；最后在第六节对全文进行总结与展望。

## 方法

### 系统模型

考虑一个多天线 OFDM 系统，如图 1 所示。JSC 系统包含分别用于通信和感知的发射（Tx）天线阵列（含$N_T$个阵元）和接收（Rx）天线阵列（含$N_R$个阵元）。对于发射和接收天线阵列，均采用半波长间距的均匀线阵（ULA），即$d = \lambda/2$，其中$\lambda = c/f_c$（$c$为光速，$f_c$为载波频率）。通信系统向小区内的用户设备（UE）发射具有$M$个 OFDM 符号和$K$个活动子载波的 5G NR 波形 \[35]。第$n$个天线发射信号的等效低通（ELP）表示可写为：

$s_{n}(t)=\sum _{m=0}^{M-1}\left( \sum _{k=0}^{K-1}\tilde {x}_{n,k}^{(m)}e^{j2\pi {\frac {k}{T}}t}\right) g(t-mT_{s}) \quad (1)$

式中，$\tilde{x}_{n,k}^{(m)}$是从复调制星座图中选取的调制符号，用于在第$m$个 OFDM 符号和第$k$个子载波上通过第$n$个发射天线的数字预编码传输给 UE；$g(t)$为所采用的脉冲；$\Delta f = 1/T$为子载波间隔；$T_s$为包含循环前缀（CP）的 OFDM 符号持续时间。

#### 联合波形

定义向量$\tilde{x}_{k}^{(m)} \in \mathbb{C}^{N_T \times 1}$为$\tilde{x}_{k}^{(m)} = w_T x_{k}^{(m)}$，其中$w_T \in \mathbb{C}^{N_T \times 1}$是用于将每个调制符号$x_{k}^{(m)}$映射到发射天线的预编码向量。

具体而言，研究考虑一种多波束系统，OFDM 发射信号的功率在通信和感知之间分配，即总可用功率一部分用于环境感知，另一部分用于向 UE 传输 \[12,34]。因此，发射波束成形（BF）向量$w_T$可表示为 \[12]：

$w_{T}=\sqrt{\rho} w_{T, s}+\sqrt{1-\rho} w_{T, c}$

式中，$\rho \in [0,1]$是用于控制分配给两个方向的总功率占比的参数；$w_{T,c}$和$w_{T,s}$分别为通信和感知波束成形向量，其定义如下 \[35]：

$w_{T, c}=\frac{\sqrt{P_{T} G_{T}^{a}}}{N_{T}} a_{T}^{c}\left(\theta_{T, c}\right)$

$w_{T, s}=\frac{\sqrt{P_{T} G_{T}^{a}}}{N_{T}} a_{T}^{c}\left(\theta_{T, s}\right)$

其中，$G_T^a$是沿波束指向方向（该方向增益最大）的发射阵列增益；$P_T G_T^a$是有效全向辐射功率（EIRP）；$a_T(\theta_{T,c}) \in \mathbb{C}^{N_T \times 1}$和$a_T(\theta_{T,s}) \in \mathbb{C}^{N_T \times 1}$分别为通信和感知的导向向量。对于均匀线阵（ULA），在给定到达角（DoA）/ 离开角（DoD）$\theta_l$处的空间导向向量为 \[36, 第 9 章]、\[35, 第 5 章]：

$a\left(\theta_{l}\right)=\left[1, e^{j 2 \pi d sin \left(\theta_{l}\right) / \lambda}, ..., e^{j 2 \pi\left(N_{a}-1\right) d sin \left(\theta_{l}\right) / \lambda}\right]^{T} \quad (5)$

式中，$N_a$为阵列天线阵元数。由于考虑半波长间距，式（5）可简化为：

$a\left(\theta_{l}\right)=\left[1, e^{j \pi sin \left(\theta_{l}\right)}, ..., e^{j \pi\left(N_{a}-1\right) sin \left(\theta_{l}\right)}\right]^{T} \quad (6)$

#### 接收信号

OFDM 接收机中，经过快速傅里叶变换（FFT）模块后，每个天线接收的调制符号向量$\tilde{y}_{k}^{(m)} \in \mathbb{C}^{N_R \times 1}$可表示为：

$\tilde{y}_{k}^{(m)}=H_{k}^{(m)} \tilde{x}_{k}^{(m)}+\tilde{\nu}_{k}^{(m)}+\tilde{n}_{k}$

式中，$H_{k}^{(m)} \in \mathbb{C}^{N_R \times N_T}$是第$m$个 OFDM 符号和第$k$个子载波的信道矩阵；$\tilde{\nu}_{k}^{(m)} \in \mathbb{C}^{N_R \times 1}$是每个接收天线处由发射 - 接收（Tx-Rx）隔离不完善引起的自干扰（SI）向量；$\tilde{n}_k \in \mathbb{C}^{N_R \times 1}$是加性高斯白噪声（AWGN）向量，其元素为独立同分布（i.i.d.）的随机变量（r.v.s），服从零均值圆对称高斯分布，方差为$\sigma_N^2$。

考虑$L$个点目标反射，信道矩阵可表示为：

$H_{k}^{(m)}=\sum_{l=1}^{L} \underbrace{\alpha_{l} e^{j 2 \pi m T_{s} f_{D, l}} e^{-j 2 \pi k \Delta f \tau_{l}}}_{\triangleq \beta_{l}} a_{R}\left(\theta_{l}\right) a_{T}^{T}\left(\theta_{l}\right)$

式中，$\tau_l$、$f_{D,l}$和$\theta_l$分别为第$l$个目标的往返时延、多普勒频移和到达角（DoA）；$\alpha_l = |\alpha_l| e^{j\phi_l}$是复幅度，包含第$l$条传播路径的相移和衰减；$a_R(\theta_l)$表示感知时接收端的阵列响应向量。为简化到达角（DoA）估计方法的表述，式（8）可重写为更简洁的形式：

$H_{k}^{(m)}=A_{R}(\theta) \sum A_{T}^{T}(\theta)$

其中，$A_R(\theta) = [a_R(\theta_1), ..., a_R(\theta_L)] \in \mathbb{C}^{N_R \times L}$和$A_T(\theta) = [a_T(\theta_1), ..., a_T(\theta_L)] \in \mathbb{C}^{N_T \times L}$分别为目标方向$\theta = [\theta_1, \theta_2, ..., \theta_L]$的导向矩阵；$\sum = diag(\beta_1, \beta_2, ..., \beta_L) \in \mathbb{C}^{L \times L}$是信道系数对角矩阵。

对于式（7）中的自干扰（SI）项$\tilde{\nu}_{k}^{(m)}$，其向量的每个元素$n$可视为由距离接收机几乎为零的静态目标散射产生的信号，即多普勒频移$f_{D,SI}=0$且时延$\tau_{SI}=0$，因此可表示为$\tilde{\nu}_{n,k}^{(m)} = \alpha_{SI,n} x_{k}^{(m)}$，其中$\alpha_{SI,n} = |\alpha_{SI,n}| e^{j\phi_{SI,n}}$是复幅度，包含第$n$个接收天线阵元处自干扰（SI）分量的相移和衰减 \[6,39]。与目标情况类似，假设所有接收天线的衰减因子$\alpha_{SI,n}$相同。因此，每个接收天线处第$l$个目标回波的信干比（SSIR）为：

$SSIR=\frac{\left|\alpha_{l}\right|^{2}}{\left|\alpha_{SI}\right|^{2}} \quad (10)$

由式（7）出发，通过接收波束成形（BF）向量$w_R = a_R^c(\theta_{R,s})$进行空间合并，可得接收符号$y_{k}^{(m)} = w_R^T \tilde{y}_{k}^{(m)}$，结合式（9）可表示为：

$y_{k}^{(m)}=w_{R}^{T}A_{R}(\theta )\sum A_{T}^{T}(\theta ){\tilde {x}}_{k}^{(m)}+w_{R}^{T}{\tilde {\nu }}_{k}^{(m)}+w_{R}^{T}{\tilde {n}}_{k} \quad (11)$

#### 波束扫描

如前所述，所考虑的系统是一种多波束 JSC 方案，一束波束指向用户设备（UE），另一束波束依次指向不同方向以实现环境感知。

参考图 1，在扫描过程中，感知的离开角（DoD）和到达角（DoA）相同，具体可表示为：

$\theta _{T,s}=\theta _{R,s}=\theta _{0}+i\Delta \theta _{s}, i=0,...,N_{dir}-1 \quad (12)$

式中，$\theta_0$为起始扫描方向；$\Delta \theta_s$为扫描角步长；$i$为用于更新方向的索引；$N_{dir}$为从$-\theta_0$到$\theta_0$完成一次完整扫描所需探测的方向数。对于每个感知方向，从接收系统获取$M_s < M$个 OFDM 符号。由于包含$M$个符号的 5G NR 帧持续时间$T_f = 10$ms，因此固定$N_{dir}$后，可根据下式确定完成一次扫描所需的帧数和时间：

$N_{f}=\left\lceil\frac{M_{s} N_{dir}}{M}\right\rceil, T_{scan}=T_{f} N_{f} \quad (13)$

在每个方向收集的 OFDM 符号用于估计目标的距离、多普勒频移和到达角（DoA）。

#### 传感器 - 目标 - 传感器路径

在视距（LOS）传播条件下，某个阵列阵元从第$l$条路径（由感知波束照射）接收到的功率与$|\alpha_l|^2$成正比，可表示为 \[36]：

$P_{R, l}=\rho \cdot \frac{P_{T} G_{T}^{a} G_{R} c^{2} \sigma_{RCS, l}}{(4 \pi)^{3} f_{c}^{2} d_{l}^{4}} \cdot \gamma_{l}$

式中，$\sigma_{RCS,l}$为点目标$l$的雷达截面积（RCS）；$d_l$为第$l$个目标与基站（BS）之间的距离；$G_R$为接收端（RX）单个阵元的天线增益；$\gamma_l = |AF(\theta_{T,s} - \theta_l)|^2 \in [0,1]$（其中$AF(\theta)$是发射端的归一化阵列因子，用于考虑目标到达角（DoA）与感知方向之间的非完美对准 \[40]），当$\theta_l = \theta_{T,s}$时，$\gamma_l = 1$。单个接收天线阵元处与第$l$个目标相关的信噪比（SNR）定义为：

$SNR_{l}=\frac{P_{R, l}}{N_{0} K \Delta f} \quad (15)$

式中，$P_{R,l}$为从第$l$条路径接收到的功率（由式（14）给出）；$N_0$为每个天线阵元处的单边噪声功率谱密度（PSD）。在方便的情况下，通过对 OFDM 接收机中 FFT 后的接收符号进行归一化（使得$\mathbb{E}\{|\tilde{y}_{n,k}^{(m)}|^2\} = 1$），式（15）可简化为$SNR_l = 1/\sigma_N^2$。

### 目标参数估计与检测

本节介绍用于到达角（DoA）估计的多重信号分类（MUSIC）算法，以及用于距离和速度估计的基于周期图的频率估计方法。这些估计方法在每个感知波束步长（在此过程中收集$M_s$个 OFDM 符号）中执行。为简化符号表示，省略扫描索引$i$。

#### 目标数量与到达角（DoA）估计

到达角（DoA）估计通过 MUSIC 算法实现，该算法需要知晓噪声子空间，而噪声子空间的获取又依赖于已知的目标数量。噪声子空间可通过接收向量（式（7））的协方差矩阵$R = \mathbb{E}\{\tilde{y}_{k}^{(m)} \tilde{y}_{k}^{(m)\dagger}\} \in \mathbb{C}^{N_R \times N_R}$来确定。实际上，由于噪声均值为零且与目标回波相互独立，协方差矩阵$R$的$N_R - L$个最小特征值均等于噪声功率$\sigma_N^2$，其对应的特征向量即为噪声子空间 \[3]。由于协方差矩阵无法预先知晓，因此可采用样本协方差矩阵（SCM）替代 \[32]，其表达式为：

$\hat{R}=\frac{1}{K M_{s}} \sum_{m=0}^{M_{s}-1} \sum_{k=0}^{K-1} \tilde{y}_{k}^{(m)} \tilde{y}_{k}^{(m) \dagger}$

可通过基于信息论准则的模型阶数选择方法来估计信源（本场景中为目标回波）数量 \[41,42]。该方法首先对观测向量的样本协方差矩阵（SCM）进行特征值分解，即$\hat{R} = U \Lambda U^\dagger$，其中$U \in \mathbb{C}^{N_R \times N_R}$的列向量为特征向量，$\Lambda = diag(\lambda_1, ..., \lambda_{N_R})$为对角矩阵，且特征值按降序排列（$\lambda_1 \geq \lambda_2 \geq \cdots \geq \lambda_{N_R}$）。利用最小描述长度（MDL）准则，在第$i$个方向的感知波束所照射的目标范围内，估计的目标数量为：

$L_{m}=\underset{s \in\left\{0, ..., N_{R}-1\right\}}{arg min }\{MDL(s)\} \quad (17)$

其中，

$\begin{aligned} MDL(s) & =-ln \left(\frac{\prod_{i=s+1}^{N_{R}} \lambda_{i}^{1 /\left(N_{R}-s\right)}}{\frac{1}{N_{R}-s} \sum_{i=s+1}^{N_{R}} \lambda_{i}}\right)^{\left(N_{R}-s\right) K M_{s}} \\ & +\frac{1}{2} s\left(2 N_{R}-s\right) ln \left(K M_{s}\right) \end{aligned}$

MUSIC 算法首先构建子矩阵$\tilde{U} \in \mathbb{C}^{N_R \times (N_R - L_m)}$，该子矩阵包含与最小特征值$\lambda_{L_m + 1}, ..., \lambda_{N_R}$对应的$N_R - L_m$个特征向量，这些特征向量可较好地近似噪声子空间。随后，可得到伪谱函数，其峰值位置能够反映入射信号的存在 \[43]：

$f_{m}(\theta)=\frac{1}{\left\| \tilde{U}^{\dagger} a(\theta)\right\| _{2}^{2}} \quad (19)$

伪谱函数$f_m(\theta)$的峰值位置即为到达角（DoA）的估计值$\hat{\theta}$。然而，正如第五节中将详细说明的，在每个感知方向上，需在有限的角度范围$[\theta_{min}, \theta_{max}]$内搜索式（19）的局部最大值，该角度范围取决于阵列响应的波束宽度。因此，每个方向上的到达角（DoA）估计值为：

$\hat{\theta}=\underset{\theta \in\left[\theta_{min }, \theta_{max }\right]}{arg max }\left\{f_{m}(\theta)\right\} \quad (20)$

#### 检测与距离 - 多普勒估计

为得到距离 - 多普勒分布图，首先从接收符号（式（11））出发，通过展开矩阵乘法可得：

$y_{k}^{(m)}=\left( \sum _{l=1}^{L}\beta _{l}\Upsilon (\theta _{T,s},\theta _{R,s},\theta _{l})\right) x_{k}^{(m)}+n_{k} \quad (21)$

式中，$n_k = w_R^T \tilde{n}_k$；$\Upsilon(\theta_{T,s}, \theta_{R,s}, \theta_l) \in \mathbb{C}$是一个因子，用于考虑发射端（Tx）和接收端（Rx）阵列响应向量以及目标到达角（DoA）带来的增益。由于目标的距离和速度信息包含在$\beta_l$中，首先需进行除法运算以去除无用的数据符号 \[44]，即$g_{k}^{(m)} = y_{k}^{(m)} / x_{k}^{(m)}$，由此可得：

$g_{k}^{(m)}=\sum_{l=1}^{L} \alpha_{l} e^{j 2 \pi m T_{s} f_{D, l}} e^{-j 2 \pi k \Delta f \tau_{l}} \Upsilon\left(\theta_{T, s}, \theta_{R, s}, \theta_{l}\right)+\nu_{k}$

式中，$\nu_k = n_k / x_{k}^{(m)}$。需要注意的是，式（22）中每个目标对应两个复正弦信号，其频率分别与$f_{D,l}$和$\tau_l$相关，而$\alpha_l$和$\Upsilon(\theta_{T,s}, \theta_{R,s}, \theta_l)$为常数项。

基于式（22），可通过计算周期图来估计目标的距离和速度 \[6,44,45]：

$\mathcal{P}(q, p)=\left|\sum_{k=0}^{K_{p}-1}\left(\sum_{m=0}^{M_{p}-1} g_{k}^{(m)} e^{-j 2 \pi \frac{m p}{M_{p}}}\right) e^{j 2 \pi \frac{k q}{K_{p}}}\right|^{2}$

其中，$q = 0, ..., K_p - 1$，$p = 0, ..., M_p - 1$。该周期图的计算过程包括$K$次长度为$M_p$的快速傅里叶变换（FFT）和$M_s$次长度为$K_p$的逆快速傅里叶变换（IFFT）。本研究中，$K_p > K$取$K$的下一个 2 的幂次，$M_p > M_s$取$F_p \cdot M_s$的下一个 2 的幂次（其中$F_p$为用于提高速度估计分辨率的补零因子）。

周期图（式（23））即为距离 - 多普勒分布图，基于该图首先通过假设检验进行目标检测，区分仅存在噪声的假设$H_0$和存在目标的假设$H_1$，即：

$\mathcal{P}(q, p) \underset{H_{0}}{\stackrel{H_{1}}{\gtrless}} \eta$

阈值$\eta$的选择需确保预设的虚警概率$P_{FA}$。当感知波束宽度较小时，某个感知方向上可能仅存在一个目标，若假设检验（式（24））拒绝零假设，则可轻松找到周期图中的峰值位置：

$(\hat{q}, \hat{p})=\underset{(q, p)}{arg max }\{\mathcal{P}(q, p)\}$

进而估算目标的距离和径向速度：

$\hat{r}=\frac{\hat{q} c}{2 \Delta f K_{p}}, \hat{v}=\frac{\hat{p} c}{2 f_{c} T_{s} M_{p}}$

距离分辨率和速度分辨率是周期图的固有特性，仅取决于 5G NR 参数（即 OFDM 符号数、活动子载波数、子载波间隔和 OFDM 符号持续时间），其表达式为 \[44, 第 3 章]：

$\Delta r=\frac{c}{2 \Delta f K_{p}}, \Delta v=\frac{c}{2 f_{c} T_{s} M_{p}}$

#### 冗余目标点修剪

如前所述，所考虑的 JSC 系统在每个感知方向（假设检验（式（24））选择假设$H_1$的方向）上，会在伪谱（式（19））和周期图（式（23））中搜索峰值。当在某个方向检测到目标时，由于波束旁瓣的影响，若周期图$P$超过阈值，该目标也可能在相邻方向被检测到。这些检测点源自同一目标，但其到达角（DoA）估计值存在偏差。正如第五节中将进一步量化的，这种现象是由于在有限范围内（如式（20）所示）搜索 MUSIC 伪谱最大值导致的，虽然这种局部搜索方式降低了计算成本，但可能会导致每个目标对应多个检测点。为保留局部搜索的优势，研究提出了一种剔除冗余目标点（以下也称为重复目标）的方法，该方法已被证明是有效的。

首先，将所有收集到的峰值和估计值整理成矩阵$Z$，其每行向量为：

$z_{i}=\left[ \hat {r}_{i},\hat {v}_{i},\mathcal {P}(\hat {r}_{i},\hat {v}_{i}),\hat {\theta }_{i},f_{m}(\hat {\theta }_{i})\right], i=1,...,N_{max} \quad (28)$

式中，$N_{max} \leq N_{dir}$是假设检验（式（24））拒绝零假设的感知方向数。随后，根据$P(\hat{r}_i, \hat{v}_i)$的值将矩阵$Z$的行按降序排序，形成新的矩阵$Z_{sort}$。最后，对$Z_{sort}$的元素进行检查，剔除冗余目标点（即距离和径向速度估计值非常接近（在给定不确定性范围内）的点），得到新的矩阵$Z_{prun}$，其行数$\hat{L} \leq N_{max}$。排序操作确保在重复点中，仅保留与周期图最大值相关的距离和速度对。完整的流程详见算法 1。可以看出，冗余目标点的定义与两个参数$\epsilon_r$和$\epsilon_v$的选择相关，这两个参数用于考虑测量不确定性。具体而言，在算法中，若索引为$i$的目标的估计距离$\hat{r}_i$和速度$\hat{v}_i$分别满足$\hat{r}_j - \epsilon_r \leq \hat{r}_i \leq \hat{r}_j + \epsilon_r$和$\hat{v}_j - \epsilon_v \leq \hat{v}_i \leq \hat{v}_j + \epsilon_v$，则该目标被视为已检测到的索引为$j$的目标的重复项。关于参数$\epsilon_r$和$\epsilon_v$的选择将在第五节中讨论。

### 多目标场景下的性能评估

本节介绍用于描述多目标系统中 “失准距离”（即误差）的性能度量。具体而言，在考虑多目标系统时，一个合理的度量不仅应能反映定位误差，还应能体现数量误差，即需捕捉两组向量（真实向量和估计向量）之间的差异。基于此，本研究采用最优子模式分配（OSPA）度量 \[46,47] 来评估所考虑的 JSC 系统在多目标场景下的性能。

OSPA 度量是一种失准距离指标，它将目标数量和位置的估计精度综合为一个单一度量值。具体而言，给定$L$个目标的真实位置$P = [p_1, ..., p_L]$（其中$p_l = (x_l, y_l) = (r_l cos\theta_l, r_l sin\theta_l)$）和$\hat{L}$个估计位置$\hat{P} = [\hat{p}_1, ..., \hat{p}_{\hat{L}}]$，任意一对估计位置与真实位置之间的距离（截断值为$\bar{c} > 0$）定义为 \[46]：

$d^{(\bar{c})}(p, \hat{p}) = min\{\bar{c}, d(p, \hat{p})\}$

式中，$d(p, \hat{p}) = \|p - \hat{p}\|_2$是估计位置与真实位置之间的欧几里得距离；$\bar{c}$是截断参数，用于确定该度量在数量误差和定位误差之间的权衡权重。对于任意$k \in \mathbb{N}$，用$\Pi_k$表示集合$\{1,2,...,k\}$上的所有排列。对于$1 \leq q \leq \infty$和$\bar{c} > 0$，$q$阶且截断值为$\bar{c}$的 OSPA 度量定义为 \[46]：

$\begin{aligned} \bar{d}_{q}^{(\bar{c})} & (P, \hat{P})= \\ & \left(\frac{1}{\hat{L}}\left(min _{\pi \in \Pi_{\hat{L}}} \sum_{l=1}^{L}\left(d^{(\bar{c})}\left(p_{l}, \hat{p}_{\pi(l)}\right)\right)^{q}+\bar{c}^{q}(\hat{L}-L)\right)\right)^{1/q} \quad (30) \end{aligned}$

当$L \leq \hat{L}$时，OSPA 距离按上述公式计算；当$L > \hat{L}$时，$\bar{d}_{q}^{(\bar{c})}(P, \hat{P}) = \bar{d}_{q}^{(\bar{c})}(\hat{P}, P)$。实际上，当$L \leq \hat{L}$时，OSPA 距离可通过以下步骤计算：



1.  从估计位置集合$\hat{P}$中选取$L$个元素，使其与真实位置集合$P$的距离最短，这对应于最优子模式分配；

2.  若估计位置$\hat{p}_n \in \hat{P}$未与真实位置集合$P$中的任何位置配对，则令$d_n = \bar{c}$；否则，$d_n$取$\bar{c}$与配对位置间距离中的较小值；

3.  OSPA 距离可表示为$\bar{d}_{q}^{(\bar{c})}(P, \hat{P}) = \left( \frac{\sum_{l=1}^{L} d_n^q}{\hat{L}} \right)^{1/q}$。

OSPA 距离可理解为多目标场景下的 “每目标$q$阶误差”。该度量可分为两个部分，一部分用于衡量定位误差，另一部分用于衡量数量误差。具体而言，对于$q < \infty$，这两部分分别为 \[46]：

$\bar{e}_{q, loc}^{(\bar{c})}(P, \hat{P})=\left(\frac{1}{\hat{L}} min _{\pi \in \Pi_{\hat{L}}} \sum_{l=1}^{L}\left(d^{(\bar{c})}\left(p_{l}, \hat{p}_{\pi(l)}\right)\right)^{q}\right)^{1/q}$

$\bar{e}_{q, card }^{(\bar{c})}(P, \hat{P})=\left(\frac{\bar{c}^{q}(\hat{L}-L)}{\hat{L}}\right)^{1/q}$

当$L \leq \hat{L}$时，按上述公式计算；当$L > \hat{L}$时，$\bar{e}_{q, loc}^{(\bar{c})}(P, \hat{P}) = \bar{e}_{q, loc}^{(\bar{c})}(\hat{P}, P)$，$\bar{e}_{q, card}^{(\bar{c})}(P, \hat{P}) = \bar{e}_{q, card}^{(\bar{c})}(\hat{P}, P)$。

在该度量中，参数$q$决定了$\bar{d}_{q}^{(\bar{c})}$对异常估计值的敏感度；参数$\bar{c}$用于平衡数量误差部分与定位误差部分在总误差中的占比。随着$\bar{c}$的减小，定位误差在总误差中的占比逐渐主导；而$\bar{c}$增大时，数量误差的影响则更为突出。为在两部分误差之间取得平衡，$\bar{c}$的最佳取值应显著大于典型的定位误差，同时显著小于目标间的最大距离。

## 结论

本研究设计了一种基于 5G 新空口（NR）的联合感知与通信（JSC）多波束系统，该系统能够检测并定位多个目标。研究进行了系统级分析，并提出了一种算法来修剪由波束旁瓣存在下的波束扫描所产生的虚假目标。明确了影响系统性能的主要因素，并对工作在 Sub-6 GHz 和毫米波频段的两种系统配置进行了比较。研究结果表明：



1.  在评估目标位置时，到达角（DoA）估计是主要的误差来源；

2.  即使仅将相对较小比例的功率用于感知，在视距（LOS）条件下，即使在毫米波频段，也能在数十米范围内实现良好的定位性能；

3.  在 Sub-6 GHz 频段，虽然能够在更远距离检测到目标，但由于天线阵元数量减少，定位精度较低；

4.  当用于感知的功率能够确保可靠的到达角（DoA）估计时，可实现对数十个目标的检测与定位，且定位精度可达亚米级。

> （注：文档部分内容可能由 AI 生成）