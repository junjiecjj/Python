# 基于 AFDM 的通信与感知一体化（ISAC）系统理论框架及仿真实现

## 摘要

本文总结基于非正交多载波技术（AFDM）的通信与感知一体化（ISAC）系统的理论基础，该系统通过共享 AFDM 波形同时实现数据传输与目标探测功能。文中详细阐述系统的调制解调机制、目标回波模型、通信信号恢复方法及雷达感知信号处理流程，并通过星座图与距离 - 多普勒谱（RDM）可视化验证系统性能，为 ISAC 技术的波形设计与信号处理提供理论参考。

## 1. 系统概述

AFDM-ISAC 系统以自适应频率分集多载波（AFDM）为核心波形，通过单一发射信号同时承载通信信息与雷达感知任务，实现资源高效利用。系统核心目标包括：（1）通信链路：通过 AFDM 调制传输高阶 QAM 信号，经接收端均衡后恢复数据；（2）感知链路：基于目标回波的距离 - 多普勒特征估计，实现多目标的位置与速度探测。系统架构如图 1 所示（概念框架），主要包含发射端波形生成、信道与目标回波建模、接收端通信信号恢复及雷达信号处理四大模块。

## 2. 系统参数与波形设计

### 2.1 核心参数配置

系统物理层参数决定波形的时频特性，关键参数包括：



* **通信参数**：子载波数量$N$（决定频域分辨率）、慢时脉冲数$N_{\text{sym}}$（决定多普勒分辨率）、QAM 调制阶数$M$（决定通信速率）、信噪比$\text{SNR (dB)}$（表征信道噪声水平）；

* **物理层参数**：载频$f_c$（决定雷达波长$\lambda=c/f_c$）、子载波间隔$\Delta F$（决定信号带宽$B=N\Delta F$）、采样率$F_s=N\Delta F$（满足奈奎斯特准则）、循环前缀类似物（CPP）长度$N_{\text{cp}}$（对抗多径时延扩展，需大于最大目标时延对应的采样数）。

### 2.2 AFDM 波形调制原理

AFDM 波形基于离散自适应傅里叶变换（DAFT）实现调制解调，区别于传统 OFDM 的 FFT 变换，其引入 chirp 因子以增强波形的感知适应性。调制过程（发射端）为：



1. **QAM 符号生成**：随机生成$N \times N_{\text{sym}}$的$M$-QAM 符号矩阵$\mathbf{X}$，满足单位平均功率约束；

2. **逆 DAFT（IDAFT）变换**：对$\mathbf{X}$的每一列进行 IDAFT，生成时域块信号$\mathbf{s}_{\text{blocks}}$。变换公式为：

$ 
   s(n,k) = E_1(n) \cdot \text{IFFT}\left\{ E_2(m) \cdot X(m,k) \right\}, \quad n,m=0,1,\cdots,N-1; \, k=0,1,\cdots,N_{\text{sym}}-1
    $

其中，$E_1(n) = \exp(j2\pi c_1 n^2)$和$E_2(m) = \exp(j2\pi c_2 m^2)$为 chirp 调制因子，$c_1,c_2$为系统设计参数，控制时频聚焦特性；



1. **CPP 添加**：为每个时域块前缀添加$N_{\text{cp}}$个尾部采样点，形成发射信号$s_{\text{tx}}$，以消除块间干扰。

## 3. 通信链路理论

### 3.1 接收信号模型

接收信号包含目标回波与加性高斯白噪声（AWGN），即：

$ 
r_{\text{rx}} = r_{\text{echo}} + w
 $

其中，$r_{\text{echo}}$为多目标回波叠加信号，$w$为 AWGN，其功率由$\text{SNR (dB)}$决定。

### 3.2 通信信号恢复

接收端通过以下步骤恢复通信符号：



1. **CPP 去除**：将接收信号按块分割，去除前缀的$N_{\text{cp}}$个采样点，得到时域块$\mathbf{Y}_{\text{blocks}}$；

2. **DAFT 变换**：对$\mathbf{Y}_{\text{blocks}}$进行 DAFT 变换（IDAFT 的逆过程），转换至 DAFT 域：

$ 
   Y(m,k) = \text{FFT}\left\{ E_1^*(n) \cdot Y_{\text{blocks}}(n,k) \right\} \cdot E_2^*(m)
    $



1. **信道估计与均衡**：假设发射符号已知（或通过导频估计），采用最小二乘（LS）准则估计信道响应$\hat{H} = Y/X$，进而通过$\hat{X} = Y/\hat{H}$恢复接收符号；

2. **性能评估**：通过发射端星座图与接收端均衡后星座图的对比，直观评估通信信号的失真程度，反映链路可靠性。

## 4. 感知链路理论

### 4.1 目标回波模型

雷达回波由多个目标的反射信号叠加而成，单个目标的回波可建模为：

$ 
r_{\text{echo},i}(n) = h_i \cdot s_{\text{tx}}(n - l_i) \cdot \exp(j2\pi f_i n)
 $

其中，$h_i$为目标复反射系数，$l_i = \lfloor 2R_i/(cT_s) \rfloor$为目标距离$R_i$对应的时延采样数（$T_s=1/F_s$为采样间隔），$f_i = 2v_i f_c/(cF_s)$为目标速度$v_i$对应的归一化多普勒频偏（$c$为光速）。多目标回波为各单目标回波的线性叠加。

### 4.2 时域 FCCR 信号处理

采用快速互相关雷达（FCCR）方法估计目标的距离 - 多普勒信息，流程如下：



1. **快时间 FFT**：对接收时域块$\mathbf{Y}_{\text{blocks}}$和发射时域块$\mathbf{s}_{\text{blocks}}$分别进行快时间（子载波维度）FFT，得到频域信号$\mathbf{R}_f$和$\mathbf{S}_f$；

2. **频域互相关**：计算频域共轭乘积$\mathbf{Z}_f = \mathbf{R}_f \cdot \mathbf{S}_f^*$，实现信号匹配滤波；

3. **快时间 IFFT**：对$\mathbf{Z}_f$进行快时间 IFFT，得到距离维度的目标响应；

4. **慢时间 FFT**：对距离维度结果进行慢时间（脉冲维度）FFT，得到距离 - 多普勒谱（RDM）$\text{RD}$，其幅值反映目标在距离 - 速度平面的能量分布。

### 4.3 物理量换算



* **距离轴**：距离分辨率$\Delta R = c/(2F_s)$，距离坐标为$r = n \cdot \Delta R$（$n$为距离门索引）；

* **多普勒（速度）轴**：多普勒分辨率$\Delta f_d = 1/(N_{\text{sym}} T_{\text{AFDM}})$（$T_{\text{AFDM}}=(N+N_{\text{cp}})/F_s$为单符号时长），速度坐标为$v = f_d \cdot c/(2f_c)$（$f_d$为多普勒频偏）。

## 5. 可视化与性能验证

系统性能通过两类可视化结果验证：



1. **通信性能**：发射端$M$-QAM 星座图与接收端均衡后星座图的对比，反映信号解调质量，星座点聚集度越高，通信性能越优；

2. **感知性能**：2D/3D 距离 - 多普勒谱（RDM），其中 2D 图通过幅度分贝值（dB）的热力图展示目标能量分布，3D 图通过曲面直观呈现距离 - 速度 - 能量关系，叠加真实目标位置（红色标记）可量化感知精度。

## 6. 结论

AFDM-ISAC 系统通过融合 DAFT 调制的多载波通信技术与 FCCR 雷达信号处理方法，实现了通信与感知的高效一体化。理论分析与仿真流程表明，该系统可同时提供可靠的数据传输与高精度的目标探测能力，为毫米波频段（如 24GHz）ISAC 应用提供了可行的技术框架。后续可进一步优化 chirp 因子设计与信道估计算法，以提升复杂场景下的系统鲁棒性。

**关键词**：通信与感知一体化（ISAC）；AFDM；DAFT 变换；距离 - 多普勒估计；星座图
