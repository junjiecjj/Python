# MIMO-OFDM 通信系统中集成雷达感知的 ISAC 系统

以下是提取的英文内容及对应的中文翻译，已剔除所有代码部分，确保技术表述准确且语言完整。

### 1. 示例概述（Example Overview）

本示例展示如何基于通用多输入多输出 - 正交频分复用（MIMO-OFDM）通信系统，对以通信为中心的集成感知与通信（ISAC）系统进行建模。本示例的第一部分还展示了如何基于发射相位调制连续波（PMCW）波形的 MIMO 雷达，对以雷达为中心的 ISAC 系统进行建模。

### 2. 引言（Introduction）

ISAC 系统是应对频谱日益拥挤、雷达与通信系统对大带宽需求不断增长等挑战的关键策略。在 ISAC 框架中，雷达与通信功能被集成，共享相同的硬件基础设施，并采用通用的发射波形。本示例将说明如何在典型的 MIMO-OFDM 通信系统中增加雷达感知能力。

OFDM 是一种多载波信号，由一组被称为子载波的正交复指数信号构成。每个子载波的复振幅可用于承载通信数据，从而实现高数据速率传输。此外，OFDM 波形还具有多普勒容忍性，且不存在距离 - 多普勒耦合问题。这些特性使 OFDM 波形在雷达应用中具有吸引力。由于雷达功能嵌入在通信系统内部，这种 ISAC 方法被定义为 “以通信为中心”。

本示例采用双基地拓扑结构，旨在实现双重目标：发射机的主要任务是通过多个空间信道向接收机高效传输数据载荷；同时，接收机不仅要接收该数据载荷，还需通过测量特定关注目标的位置，实现对周边环境的感知。

### 3. 系统参数（System Parameters）

考虑一个工作在 6GHz 载波频率、带宽为 100MHz 的 MIMO-OFDM 通信系统。

* 发射机峰值发射功率设为 1 瓦。

* 接收机噪声系数设为 3 分贝（dB），参考噪声温度设为 290 开尔文（K）。

* 发射机与接收机均采用均匀线阵（ULA），各包含 8 个各向同性天线，天线间距为半波长。

### 4. ISAC 场景（ISAC Scenario）

* 发射机位于坐标原点，发射阵列法向沿 x 轴方向；接收机与发射机保持一定距离，接收阵列法向沿 y 轴负方向，且两者均为静止状态。

* 发射机与接收机之间的环境中存在散射体，这些散射体可能是静止的，也可能是运动的。丰富的散射环境是 MIMO 通信实现空间复用的关键，而在感知功能中，通信信道内的散射体（无论运动状态如何）均被视为雷达目标。

* 假设发射机与接收机之间的最大路径长度为 300 米，运动散射体的速度不超过 50 米 / 秒（m/s）。

* 场景中包含 3 个运动散射体（即感知功能的关注目标），其余散射体均为静止。通过`helperGenerateStaticScatterers`辅助函数，可在特定关注区域内生成静止散射体的位置。

* 采用`phased.ScatteringMIMOChannel`对象对发射机与接收机之间的传播信道进行建模，并通过`helperVisualizeScatteringMIMOChannel`辅助函数可视化散射 MIMO 信道。

### 5. 信号方案（Signaling Scheme）

本示例还展示了如何为联合通信与感知设计以下信号方案，具体流程如下：

1. **初始信道探测**：传输以导频序列（preamble）开始，接收机通过导频序列获取初始信道估计。

2. **信道编码**：接收机利用初始信道估计计算所需的预编码与合并权重，并假设反馈无延迟且完全可靠，将预编码权重回传给发射机。

3. **数据传输**：发射机发送单个帧，该帧分为两个子帧：子帧 A 仅传输数据符号；子帧 B 同时传输数据符号与导频（pilot），实现兼顾通信与感知的双重传输。

4. **信道估计与预编码权重更新**：接收机接收子帧 B 后，利用导频获取新的信道估计，重新校准预编码与合并权重，并将更新后的预编码权重回传给发射机。

5. **雷达数据立方体构建**：将当前信道估计沿发射天线维度求和，并作为单独一页存储到雷达数据立方体中。

上述流程从步骤 3 开始重复，直至传输完预设数量（`numFrames`）的帧。之后，可从收集的雷达数据立方体中估计目标位置与相对速度。

此外，信号方案还包含以下关键设计：

* OFDM 子载波数量设为 2048，子载波间隔通过带宽与子载波数量计算得出。为避免散射体运动产生的多普勒频移影响子载波正交性，子载波间隔需至少为最大多普勒频移的 10 倍（本示例中该间隔为最大多普勒频移的 48.79 倍，满足要求）。

* 为避免符号间干扰（ISI），在 OFDM 符号前添加循环前缀（CP），其时长基于最大关注距离计算。

* 部分子载波用作保护带（前 9 个与后 8 个子载波），以避免相邻频率系统的频谱泄漏。

* 子帧 B 中的导频同时用于信道均衡与雷达感知：导频在时频域的密度需平衡感知数据量与数据载荷容量，其最大间隔由最大预期时延与最大预期多普勒频移决定（本示例中，时域最大导频间隔`Mt=22`，频域最大导频间隔`Mf=10`）。

* 每帧长度设为时域导频间隔（`Mt`），子帧 B 长度等于发射天线数量（各天线在不同 OFDM 符号中传输导频以避免干扰），剩余符号归属于子帧 A。

### 6. 初始信道探测（Initial Channel Sounding）

导频序列用于获取初始信道估计，并计算空间复用所需的预编码与合并权重。本示例中，导频序列由单个 OFDM 符号构成，不同发射天线使用不同子载波传输导频（避免干扰）。

* 导频符号采用最大长度序列（MLS）生成，所有发射天线使用相同的导频值。

* 通过`comm.OFDMModulator`与`comm.OFDMDemodulator`对象分别实现导频的调制与解调。

* 发射机发送调制后的导频信号，信号经信道传播后，由接收机添加热噪声并解调；再通过`helperInterpolateChannelMatrix`辅助函数计算信道估计，通过`diagbfweights`函数计算预编码与合并权重。

### 7. 数据帧传输（Data Frame Transmission）

#### 7.1 调制解调配置

* 子帧 A 仅传输数据，通过`comm.OFDMModulator`与`comm.OFDMDemodulator`对象实现调制解调。

* 子帧 B 的导频在频域间隔`Mf`个子载波，各发射天线在不同 OFDM 符号中传输导频（导频同样基于 MLS 序列生成），并通过专用的调制解调对象处理。

#### 7.2 关键参数与性能

* 假设 24 个 OFDM 帧的雷达数据可进行相干处理，相干处理间隔（CPI）决定多普勒分辨率，最终速度分辨率为 4.21 m/s。

* 系统采用 64 正交振幅调制（64-QAM），每个符号承载 6 比特数据，调制阶数为 64。

* 利用多天线与丰富散射环境实现空间复用，发射机通过 2 个空间信道向接收机传输 2 路独立数据流。

#### 7.3 传输与接收流程

对每帧数据依次执行以下操作：

1. 生成子帧 A 与子帧 B 的二进制数据载荷，通过 64-QAM 调制为符号。

2. 对调制后的符号进行预编码，生成 OFDM 符号。

3. 合并子帧 A 与子帧 B，形成完整 OFDM 帧并逐符号传输；传输过程中实时更新目标位置。

4. 接收机接收信号，分离子帧 A 与子帧 B 并分别解调，对解调后的符号应用合并权重。

5. 解调 QAM 数据并计算每帧的误码率（BER），24 帧的误码率范围为 0.0055\~0.0132。

6. 利用子帧 B 的导频更新信道估计与预编码 / 合并权重，并将当前信道估计沿发射天线维度求和后，存储到雷达数据立方体中。

最后，通过`comm.ConstellationDiagram`对象绘制最后一帧接收数据的 64-QAM 星座图。

### 8. 雷达数据处理（Radar Data Processing）

在已知发射机与接收机位置的前提下，可通过雷达数据立方体估计信道中散射体的位置。由于关注目标为运动散射体，可在多普勒域滤除静止散射体（静止散射体的多普勒频移为 0），具体步骤如下：

1. 对雷达数据立方体沿慢时间维度执行快速傅里叶变换（FFT），并将直流分量置零以去除静止散射体影响，再通过逆 FFT（IFFT）得到处理后的数据。

2. 利用`helperPositionHeatmap`辅助类绘制热图，展示关注区域内运动散射体的位置。

3. 通过`phased.RangeDopplerResponse`对象计算距离 - 多普勒响应（注：图中距离为 “总和距离”，多普勒频移为双基地多普勒频移；若需估计目标实际速度，需采用多基地雷达配置，即多个分布式发射机或接收机）。

4. 对所有接收天线的信号进行非相干积分，绘制距离 - 多普勒响应图，并标记出关注目标的双基地多普勒频移与总和距离。

### 9. 结论（Conclusion）

本示例展示了如何在通用 MIMO-OFDM 通信系统中集成雷达感知能力，将其转化为 ISAC 系统。具体流程包括：搭建含单个发射阵列与接收阵列的 MIMO-OFDM 通信系统、配置含静止与运动散射体的散射信道、设计兼顾数据传输与目标感知的信号方案（利用导频实现双重功能）、传输多帧 OFDM 数据并构建雷达数据立方体，最终从数据立方体中估计运动散射体的位置与双基地多普勒频移。由于雷达处理在接收机端进行，本示例中的雷达配置为双基地模式。

### 10. 参考文献（References）

1. Liu, F., Masouros, C., Petropulu, A. P., Griffiths, H., & Hanzo, L. (2020). Joint radar and communication design: Applications, state-of-the-art, and the road ahead. *IEEE Transactions on Communications*, 68(6), 3834-3862.

   （《雷达与通信联合设计：应用、研究现状与未来方向》，《IEEE 通信汇刊》）

2. Liu, A., Huang, Z., Li, M., Wan, Y., Li, W., Han, T. X., Liu, C., et al. (2022). A survey on fundamental limits of integrated sensing and communication. *IEEE Communications Surveys & Tutorials*, 24(2), 994-1034.

   （《集成感知与通信的基本极限综述》，《IEEE 通信综述与教程》）

3. de Oliveira, L. G., Nuss, B., Alabd, M. B., Diewald, A., Pauli, M., & Zwick, T. (2021). Joint radar-communication systems: Modulation schemes and system design. *IEEE Transactions on Microwave Theory and Techniques*, 70(3), 1521-1551.

   （《雷达 - 通信联合系统：调制方案与系统设计》，《IEEE 微波理论与技术汇刊》）

4. Sit, Y. L., Nuss, B., & Zwick, T. (2017). On mutual interference cancellation in a MIMO OFDM multiuser radar-communication network. *IEEE Transactions on Vehicular Technology*, 67(4), 3339-3348.

   （《MIMO-OFDM 多用户雷达 - 通信网络中的互干扰消除》，《IEEE 车辆技术汇刊》）

### 11. 辅助函数说明（Supporting Functions）

`helperBistaticDopplerShift`函数用于计算双基地多普勒频移，具体功能为：针对位于`tgtPos`位置、以`tgtVel`速度运动的目标，计算由`txPos`处的静止发射机发射、`rxPos`处的静止接收机接收的信号所产生的多普勒频移。

要不要我帮你整理一份**ISAC 系统关键术语对照表**？包含文中所有核心技术术语（如 MIMO-OFDM、ISAC 等）的中英文全称、缩写及简要释义，方便你快速查阅。

> （注：文档部分内容可能由 AI 生成）